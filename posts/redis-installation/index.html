<!doctype html><html lang="en"><head><title data-react-helmet="true">Redis high availavility installation</title><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" name="generator" content="Phenomic 0.20.4"/><meta data-react-helmet="true" property="og:site_name" content="jgipsy"/><meta data-react-helmet="true" name="twitter:site" content="@JBcnGipsy"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Redis high availavility installation"/><meta data-react-helmet="true" property="og:url" content="https://jgipsy.github.io/posts/redis-installation/"/><meta data-react-helmet="true" property="og:image" content="https://jgipsy.github.io/../../assets/hands.svg"/><meta data-react-helmet="true" property="og:description" content="Cookbook to install redis in high availability in master-slave tipology Install redis in a host &amp;lt;APP_SERVER_1_IP&gt; Fill form Configure…"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Redis high availavility installation"/><meta data-react-helmet="true" name="twitter:creator" content="@JBcnGipsy"/><meta data-react-helmet="true" name="twitter:description" content="Cookbook to install redis in high availability in master-slave tipology Install redis in a host &amp;lt;APP_SERVER_1_IP&gt; Fill form Configure…"/><meta data-react-helmet="true" name="twitter:image" content="https://jgipsy.github.io/../../assets/hands.svg"/><meta data-react-helmet="true" name="description" content="Cookbook to install redis in high availability in master-slave tipology Install redis in a host &amp;lt;APP_SERVER_1_IP&gt; Fill form Configure…"/><link rel="stylesheet" href="/phenomic.browser.94be5559fb149406d8d5.css"/><script data-react-helmet="true" src="https://cdn.polyfill.io/v2/polyfill.min.js"></script></head><body><div id="phenomic"><div class="_2Mf6m" data-reactroot="" data-reactid="1" data-react-checksum="-955801252"><div hidden="" data-reactid="2"><!-- react-empty: 3 --><!-- react-empty: 4 --><style data-reactid="5">@-ms-viewport { width: device-width; }</style></div><header class="_2gGRo" data-reactid="6"><script data-reactid="7">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','UA-93147523-1');</script><nav class="_2frUm" data-reactid="8"><div class="_37D8R" data-reactid="9"><a class="Ezg15" href="/" data-reactid="10">Home</a></div><div class="_3VLYQ" data-reactid="11"><a href="https://twitter.com/JBcnGipsy" class="Ezg15" data-reactid="12"><span class="SVGInline SVGInline--cleaned" data-reactid="13"><svg class="SVGInline-svg SVGInline--cleaned-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 4.557a9.83 9.83 0 0 1-2.828.775 4.932 4.932 0 0 0 2.165-2.724 9.864 9.864 0 0 1-3.127 1.195 4.916 4.916 0 0 0-3.594-1.555c-3.18 0-5.515 2.966-4.797 6.045A13.978 13.978 0 0 1 1.67 3.15a4.93 4.93 0 0 0 1.524 6.573 4.903 4.903 0 0 1-2.23-.616c-.053 2.28 1.582 4.415 3.95 4.89a4.935 4.935 0 0 1-2.224.084 4.928 4.928 0 0 0 4.6 3.42A9.9 9.9 0 0 1 0 19.54a13.94 13.94 0 0 0 7.548 2.212c9.142 0 14.307-7.72 13.995-14.646A10.025 10.025 0 0 0 24 4.556z"/></svg></span><!-- react-text: 14 -->Twitter<!-- /react-text --></a><a href="https://github.com/jgipsy" class="Ezg15" data-reactid="15"><span class="SVGInline SVGInline--cleaned" data-reactid="16"><svg class="SVGInline-svg SVGInline--cleaned-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.6.11.793-.26.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.09-.745.083-.73.083-.73 1.205.085 1.84 1.238 1.84 1.238 1.07 1.834 2.806 1.304 3.49.997.108-.776.42-1.306.763-1.605-2.665-.305-5.467-1.334-5.467-5.93 0-1.312.47-2.382 1.236-3.222-.125-.303-.536-1.524.116-3.176 0 0 1.008-.322 3.3 1.23A11.51 11.51 0 0 1 12 5.803c1.02.005 2.047.138 3.006.404 2.29-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.236 1.91 1.236 3.22 0 4.61-2.807 5.625-5.48 5.922.43.372.824 1.102.824 2.222v3.293c0 .32.192.694.8.576C20.567 21.796 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg></span><!-- react-text: 17 -->GitHub<!-- /react-text --></a></div></nav></header><div class="_116Tm" data-reactid="18"><div class="sFWsg" data-reactid="19"><!-- react-empty: 20 --><div class="_3p2ZP" style="background:#de9999 url(../../assets/hands.svg) 50% 50% / cover;" data-reactid="21"><div class="_3wrxV" data-reactid="22"><div class="hOK0m" data-reactid="23"><h1 class="_1Tkeg" data-reactid="24">Redis high availavility installation</h1></div></div></div><div class="hOK0m _1z1n5" data-reactid="25"><div data-reactid="26"><header class="_2BJ2-" data-reactid="27"><time data-reactid="28">Wed Mar 01 2017</time></header></div><div class="_30RKo" data-reactid="29"><div class="phenomic-BodyContainer" data-reactid="30"><p>Cookbook to install redis in high availability in master-slave tipology</p>
<h1 id="install-redis-in-a-host-app_server_1_ip"><a href="#install-redis-in-a-host-app_server_1_ip" class="phenomic-HeadingAnchor">#</a>Install redis in a host &#x3C;APP_SERVER_1_IP></h1>
<pre><code class="hljs language-shell">wget http:<span class="hljs-comment">//download.redis.io/releases/redis-3.2.8.tar.gz</span>
tar xzf redis-3.2.8.tar.gz
<span class="hljs-keyword">cd</span> redis-3.2.8/
make
<span class="hljs-keyword">cd</span> utils
sudo ./install_server.<span class="hljs-keyword">sh</span></code></pre>
<h1 id="fill-form"><a href="#fill-form" class="phenomic-HeadingAnchor">#</a>Fill form</h1>
<pre><code class="hljs language-shell"><span class="hljs-string">Port           :</span> <span class="hljs-number">6379</span>
Config <span class="hljs-string">file    :</span> <span class="hljs-regexp">/etc/</span>redis/redis_6379.conf
Log <span class="hljs-string">file       :</span> <span class="hljs-regexp">/var/</span>log/redis_6379.log
Data <span class="hljs-string">dir       :</span> <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/redis/</span><span class="hljs-number">6379</span>
<span class="hljs-string">Executable     :</span> <span class="hljs-regexp">/home/</span>vagrant<span class="hljs-regexp">/redis-3.2.8/</span>src/redis-server
Cli <span class="hljs-string">Executable :</span> <span class="hljs-regexp">/home/</span>vagrant<span class="hljs-regexp">/redis-3.2.8/</span>src/redis-clii</code></pre>
<h1 id="configure-redis_6379conf-with-next-configuration"><a href="#configure-redis_6379conf-with-next-configuration" class="phenomic-HeadingAnchor">#</a>Configure redis_6379.conf with next configuration</h1>
<pre><code class="hljs language-shell">bind &#x3C;APP_SERVER_1_IP> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
port <span class="hljs-number">6379</span>
slave-priority <span class="hljs-number">1</span></code></pre>
<h1 id="create-sentinelconf-file"><a href="#create-sentinelconf-file" class="phenomic-HeadingAnchor">#</a>Create sentinel.conf file</h1>
<pre><code class="hljs language-shell">bind &#x3C;APP_SERVER_1_IP>
sentinel<span class="hljs-built_in"> monitor </span>redismaster &#x3C;APP_SERVER_1_IP> 6379 2  
sentinel down-after-milliseconds redismaster 6000 
daemonize yes
loglevel verbose
logfile <span class="hljs-string">"/var/log/sentinel.log"</span>
pidfile <span class="hljs-string">"/var/run/redis_26379.pid"</span></code></pre>
<h1 id="start-sentinel"><a href="#start-sentinel" class="phenomic-HeadingAnchor">#</a>Start sentinel</h1>
<pre><code class="hljs language-shell">sudo ./install_server<span class="hljs-selector-class">.sh</span>
<span class="hljs-comment">/*nohup ./redis-server /home/vagrant/redis-3.2.8/utils/sentinel.conf --sentinel &#x26;*/</span></code></pre>
<h1 id="change-etcinitdredis_26379"><a href="#change-etcinitdredis_26379" class="phenomic-HeadingAnchor">#</a>Change /etc/init.d/redis_26379</h1>
<pre><code class="hljs language-shell"><span class="hljs-meta">#!/bin/sh</span>
<span class="hljs-comment">#Configurations injected by install_server below....</span>

EXEC=/home/vagrant/redis-3.2.8/src/redis-server
CLIEXEC=/home/vagrant/redis-3.2.8/src/redis-cli
PIDFILE=/var/run/redis_26379.pid
CONF=<span class="hljs-string">"/etc/redis/sentinel.conf"</span>
REDISPORT=<span class="hljs-string">"26379"</span>
LOGFILE=<span class="hljs-string">"/var/log/sentinel.log"</span>
<span class="hljs-comment">###############</span>
<span class="hljs-comment"># SysV Init Information</span>
<span class="hljs-comment"># chkconfig: - 58 74</span>
<span class="hljs-comment"># description: redis_26379 is the redis daemon.</span>
<span class="hljs-comment">### BEGIN INIT INFO</span>
<span class="hljs-comment"># Provides: redis_26379</span>
<span class="hljs-comment"># Required-Start: $network $local_fs $remote_fs</span>
<span class="hljs-comment"># Required-Stop: $network $local_fs $remote_fs</span>
<span class="hljs-comment"># Default-Start: 2 3 4 5</span>
<span class="hljs-comment"># Default-Stop: 0 1 6</span>
<span class="hljs-comment"># Should-Start: $syslog $named</span>
<span class="hljs-comment"># Should-Stop: $syslog $named</span>
<span class="hljs-comment"># Short-Description: start and stop redis_26379</span>
<span class="hljs-comment"># Description: Redis daemon</span>
<span class="hljs-comment">### END INIT INFO</span>


<span class="hljs-keyword">case</span> <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> <span class="hljs-keyword">in</span>
    start)
        <span class="hljs-keyword">if</span> [ <span class="hljs-_">-f</span> <span class="hljs-variable">$PIDFILE</span> ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$PIDFILE</span> exists, process is already running or crashed"</span>
        <span class="hljs-keyword">else</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Starting Redis server..."</span>
            <span class="hljs-variable">$EXEC</span> <span class="hljs-variable">$CONF</span> --sentinel
        <span class="hljs-keyword">fi</span>
        ;;
    stop)
        <span class="hljs-keyword">if</span> [ ! <span class="hljs-_">-f</span> <span class="hljs-variable">$PIDFILE</span> ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$PIDFILE</span> does not exist, process is not running"</span>
        <span class="hljs-keyword">else</span>
            PID=$(cat <span class="hljs-variable">$PIDFILE</span>)
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Stopping ..."</span>
            <span class="hljs-built_in">kill</span> -9 <span class="hljs-variable">$PID</span>
            rm <span class="hljs-variable">$PIDFILE</span>
            <span class="hljs-keyword">while</span> [ -x /proc/<span class="hljs-variable">${PID}</span> ]
            <span class="hljs-keyword">do</span>
                <span class="hljs-built_in">echo</span> <span class="hljs-string">"Waiting for Redis to shutdown ..."</span>
                sleep 1
            <span class="hljs-keyword">done</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Redis stopped"</span>
        <span class="hljs-keyword">fi</span>
        ;;
    status)
        PID=$(cat <span class="hljs-variable">$PIDFILE</span>)
        <span class="hljs-keyword">if</span> [ ! -x /proc/<span class="hljs-variable">${PID}</span> ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">'Redis is not running'</span>
        <span class="hljs-keyword">else</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Redis is running (<span class="hljs-variable">$PID</span>)"</span>
        <span class="hljs-keyword">fi</span>
        ;;
    restart)
        <span class="hljs-variable">$0</span> stop
        <span class="hljs-variable">$0</span> start
        ;;
    *)
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"Please use start, stop, restart or status as first argument"</span>
        ;;
<span class="hljs-keyword">esac</span></code></pre>
<h1 id="install-redis-in-another-host-app_server_2_ip"><a href="#install-redis-in-another-host-app_server_2_ip" class="phenomic-HeadingAnchor">#</a>Install redis in another host &#x3C;APP_SERVER_2_IP></h1>
<pre><code class="hljs language-shell">wget http:<span class="hljs-comment">//download.redis.io/releases/redis-3.2.8.tar.gz</span>
tar xzf redis-3.2.8.tar.gz
<span class="hljs-keyword">cd</span> redis-3.2.8/
make
<span class="hljs-keyword">cd</span> utils
sudo ./install_server.<span class="hljs-keyword">sh</span></code></pre>
<h1 id="fill-form-1"><a href="#fill-form-1" class="phenomic-HeadingAnchor">#</a>Fill form</h1>
<pre><code class="hljs language-shell"><span class="hljs-string">Port           :</span> <span class="hljs-number">6379</span>
Config <span class="hljs-string">file    :</span> <span class="hljs-regexp">/etc/</span>redis/<span class="hljs-number">6379.</span>conf
Log <span class="hljs-string">file       :</span> <span class="hljs-regexp">/var/</span>log/redis_6379.log
Data <span class="hljs-string">dir       :</span> <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/redis/</span><span class="hljs-number">6379</span>
<span class="hljs-string">Executable     :</span> <span class="hljs-regexp">/home/</span>vagrant<span class="hljs-regexp">/redis-3.2.8/</span>src/redis-server
Cli <span class="hljs-string">Executable :</span> <span class="hljs-regexp">/home/</span>vagrant<span class="hljs-regexp">/redis-3.2.8/</span>src/redis-cli</code></pre>
<h1 id="configure-redis_6379conf-with-next-configuration-1"><a href="#configure-redis_6379conf-with-next-configuration-1" class="phenomic-HeadingAnchor">#</a>Configure redis_6379.conf with next configuration</h1>
<pre><code class="hljs language-shell">bind &#x3C;APP_SERVER_2_IP>
port <span class="hljs-number">6379</span>
slave-priority <span class="hljs-number">10</span>
slaveof &#x3C;APP_SERVER_1_IP> <span class="hljs-number">6379</span></code></pre>
<h1 id="create-sentinelconf-file-1"><a href="#create-sentinelconf-file-1" class="phenomic-HeadingAnchor">#</a>Create sentinel.conf file</h1>
<pre><code class="hljs language-shell">bind &#x3C;APP_SERVER_2_IP>
sentinel<span class="hljs-built_in"> monitor </span>redismaster &#x3C;APP_SERVER_2_IP> 6379 2  
sentinel down-after-milliseconds redismaster 6000</code></pre>
<h1 id="start-sentinel-1"><a href="#start-sentinel-1" class="phenomic-HeadingAnchor">#</a>Start sentinel</h1>
<pre><code class="hljs language-shell">sudo ./install_server<span class="hljs-selector-class">.sh</span>
<span class="hljs-comment">/*nohup ./redis-server /etc/redis/sentinel.conf --sentinel &#x26;*/</span></code></pre>
<h1 id="install-sentinel-in-a-host-app_server_3_ip"><a href="#install-sentinel-in-a-host-app_server_3_ip" class="phenomic-HeadingAnchor">#</a>Install sentinel in a host &#x3C;APP_SERVER_3_IP></h1>
<pre><code class="hljs language-shell">wget http:<span class="hljs-comment">//download.redis.io/releases/redis-3.2.8.tar.gz</span>
tar xzf redis-3.2.8.tar.gz
<span class="hljs-keyword">cd</span> redis-3.2.8/
make
<span class="hljs-keyword">cd</span> utils
sudo ./install_server.<span class="hljs-keyword">sh</span></code></pre>
<h1 id="configure-sentinelconf"><a href="#configure-sentinelconf" class="phenomic-HeadingAnchor">#</a>Configure sentinel.conf</h1>
<pre><code class="hljs language-shell">bind &#x3C;APP_SERVER_3_IP>
sentinel<span class="hljs-built_in"> monitor </span>redismaster &#x3C;APP_SERVER_3_IP> 6379 2</code></pre>
<h1 id="start-sentinel-2"><a href="#start-sentinel-2" class="phenomic-HeadingAnchor">#</a>Start sentinel</h1>
<pre><code class="hljs language-shell">sudo ./install_server<span class="hljs-selector-class">.sh</span>
<span class="hljs-comment">/*nohup ./redis-server /home/vagrant/redis-3.2.8/sentinel.conf --sentinel &#x26;*/</span></code></pre>
<h1 id="knowed-bugs"><a href="#knowed-bugs" class="phenomic-HeadingAnchor">#</a>Knowed bugs</h1>
<h2 id="if-you-see-in-log"><a href="#if-you-see-in-log" class="phenomic-HeadingAnchor">#</a>If you see in log:</h2>
<pre><code class="hljs language-shell"><span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">14.347</span> * Retrying <span class="hljs-keyword">with</span> SYNC...
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">14.347</span> # MASTER aborted replication <span class="hljs-keyword">with</span> an <span class="hljs-literal">error</span>: ERR Can<span class="hljs-symbol">'t</span> SYNC <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> connected <span class="hljs-keyword">with</span> my master
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.348</span> * Connecting <span class="hljs-keyword">to</span> MASTER &#x3C;APP_SERVER_1_IP>:<span class="hljs-number">6379</span>
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.349</span> * MASTER &#x3C;-> SLAVE sync started
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.349</span> * Non blocking connect <span class="hljs-keyword">for</span> SYNC fired the event.
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.350</span> * Master replied <span class="hljs-keyword">to</span> PING, replication can continue...
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.350</span> * Partial resynchronization <span class="hljs-keyword">not</span> possible (no cached master)
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.351</span> * Master does <span class="hljs-keyword">not</span> support PSYNC <span class="hljs-keyword">or</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">in</span> <span class="hljs-literal">error</span> state (reply: -ERR Can<span class="hljs-symbol">'t</span> SYNC <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> connected <span class="hljs-keyword">with</span> my master)</code></pre>
<p>You need to connect to redis-cli and execute this commands:</p>
<pre><code class="hljs language-shell">CONFIG <span class="hljs-keyword">SET</span> <span class="hljs-keyword">slave</span>-serve-stale-<span class="hljs-keyword">data</span> yes
SLAVEOF <span class="hljs-keyword">NO</span> ONE
CONFIG <span class="hljs-keyword">SET</span> <span class="hljs-keyword">slave</span>-serve-stale-<span class="hljs-keyword">data</span> <span class="hljs-keyword">no</span></code></pre>
<h1 id="cli-command-utils"><a href="#cli-command-utils" class="phenomic-HeadingAnchor">#</a>cli command utils</h1>
<pre><code class="hljs language-shell">/home/vagrant/redis-3.2.8/src/redis-cli

To see node role

INFO Replication

To see all stored data in <span class="hljs-keyword">cache</span>

<span class="hljs-keyword">KEYS</span> *

<span class="hljs-keyword">To</span> see all ordered <span class="hljs-keyword">keys</span> 

ZRANGE contactData~<span class="hljs-keyword">keys</span> <span class="hljs-number">0</span> <span class="hljs-number">-1</span> WITHSCORES

<span class="hljs-keyword">To</span> <span class="hljs-keyword">get</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">of</span> one <span class="hljs-keyword">key</span>

<span class="hljs-keyword">GET</span> <span class="hljs-string">"&#x3C;&#x3C;key>>"</span></code></pre>
<p>Reference: <a href="http://enmilocalfunciona.io/configuracion-basica-de-un-cluster-redis-sentinel-bajo-unix/">http://enmilocalfunciona.io/configuracion-basica-de-un-cluster-redis-sentinel-bajo-unix/</a></p>
</div></div><hr data-reactid="31"/><div data-reactid="32"><h2 class="_1vSY4" data-reactid="33">Latest Posts</h2><div data-reactid="34"><ul class="lfRQE" data-reactid="35"><li data-reactid="36"><div class="_1eeKI" data-reactid="37"><a class="_2mH_g" href="/posts/ansible-get-started/" data-reactid="38">Ansible get started</a><div class="_2l2N1" data-reactid="39"><time data-reactid="40">Wed May 31 2017</time></div><div class="_1-sEy" data-reactid="41"><!-- react-text: 42 -->instalar ansible en vuestro maquina local. En mi caso, ubuntu: Configurar las ips de los hosts a gestionar con ansible: Importante, se…<!-- /react-text --><!-- react-text: 43 --> <!-- /react-text --></div><a class="niUXw" href="/posts/ansible-get-started/" data-reactid="44"><span role="button" class="_1mmZb _1w6mX" data-reactid="45">Read More →</span></a></div></li><li data-reactid="46"><div class="_1eeKI" data-reactid="47"><a class="_2mH_g" href="/posts/apache-tunning/" data-reactid="48">Apache Tunning for Liferay</a><div class="_2l2N1" data-reactid="49"><time data-reactid="50">Thu May 18 2017</time></div><div class="_1-sEy" data-reactid="51"><!-- react-text: 52 -->vim /etc/sysconfig/httpd First change default prefork MPM for mutli-thread &amp; multi-process worker MPM: vim /etc/httpd/conf/httpd.conf…<!-- /react-text --><!-- react-text: 53 --> <!-- /react-text --></div><a class="niUXw" href="/posts/apache-tunning/" data-reactid="54"><span role="button" class="_1mmZb _1w6mX" data-reactid="55">Read More →</span></a></div></li><li data-reactid="56"><div class="_1eeKI" data-reactid="57"><a class="_2mH_g" href="/posts/liferay-dxp-migration/" data-reactid="58">Liferay DXP migration</a><div class="_2l2N1" data-reactid="59"><time data-reactid="60">Wed Apr 26 2017</time></div><div class="_1-sEy" data-reactid="61"><!-- react-text: 62 -->Configure OLD 6.2 Liferay Portal in local env Get mysql dump and store in local filesystem Start mysql docker container with 6.2 liferay…<!-- /react-text --><!-- react-text: 63 --> <!-- /react-text --></div><a class="niUXw" href="/posts/liferay-dxp-migration/" data-reactid="64"><span role="button" class="_1mmZb _1w6mX" data-reactid="65">Read More →</span></a></div></li><li data-reactid="66"><div class="_1eeKI" data-reactid="67"><a class="_2mH_g" href="/posts/redis-installation/" data-reactid="68">Redis high availavility installation</a><div class="_2l2N1" data-reactid="69"><time data-reactid="70">Wed Mar 01 2017</time></div><div class="_1-sEy" data-reactid="71"><!-- react-text: 72 -->Cookbook to install redis in high availability in master-slave tipology Install redis in a host &amp;lt;APP_SERVER_1_IP&gt; Fill form Configure…<!-- /react-text --><!-- react-text: 73 --> <!-- /react-text --></div><a class="niUXw" href="/posts/redis-installation/" data-reactid="74"><span role="button" class="_1mmZb _1w6mX" data-reactid="75">Read More →</span></a></div></li><li data-reactid="76"><div class="_1eeKI" data-reactid="77"><a class="_2mH_g" href="/posts/git-for-dummies/" data-reactid="78">Git for dummies</a><div class="_2l2N1" data-reactid="79"><time data-reactid="80">Wed Mar 01 2017</time></div><div class="_1-sEy" data-reactid="81"><!-- react-text: 82 -->The basis of any computer project is the SCM. Without a good SCM it will be difficult to reach a good port. So we want to show some first…<!-- /react-text --><!-- react-text: 83 --> <!-- /react-text --></div><a class="niUXw" href="/posts/git-for-dummies/" data-reactid="84"><span role="button" class="_1mmZb _1w6mX" data-reactid="85">Read More →</span></a></div></li></ul></div></div></div></div></div><footer class="_1Ustb" data-reactid="86"><!-- react-text: 87 -->/*<!-- /react-text --><p data-reactid="88"><a href="https://phenomic.io" class="_21LuU" data-reactid="89"><!-- react-text: 90 -->Website generated with <!-- /react-text --><span class="MMp-P" data-reactid="91">&lt;Phenomic /&gt;</span></a></p><!-- react-text: 92 -->*/<!-- /react-text --></footer></div></div><script>window.__COLLECTION__ = [{"layout":"PageError","route":"404.html","description":"","__filename":"404.md","__url":"/404.html","__resourceUrl":"/404.html","__dataUrl":"/404.html.7f6093458561a2a9bb2178ef2cba0f0f.json"},{"title":"About Phenomic base theme","hero":"https://farm4.staticflickr.com/3949/15589950511_3675b15e59_k.jpg","cta":{"label":"Discover Phenomic now","link":"https://phenomic.io/","props":{"big":true}},"description":"You are currently viewing Phenomic base theme. For now Phenomic does not provide a native way to extend themes but since it's based on…","__filename":"about.md","__url":"/about/","__resourceUrl":"/about/index.html","__dataUrl":"/about/index.html.0aea56a9b9275dff733aa3556eabd122.json"},{"title":"JGipsy","layout":"Homepage","hero":"assets/hands.svg","description":"After long years of hard work in cutting edge computer science scence, we detect that gipsy philosophy always worked.","__filename":"index.md","__url":"/","__resourceUrl":"/index.html","__dataUrl":"/index.html.051ddf750155f8b724ab03ec8e2d73c0.json"},{"title":"Ansible get started","date":"2017-05-31T00:00:00.000Z","layout":"Post","hero":"../../assets/hands.svg","description":"instalar ansible en vuestro maquina local. En mi caso, ubuntu: Configurar las ips de los hosts a gestionar con ansible: Importante, se…","__filename":"posts/ansible-get-started.md","__url":"/posts/ansible-get-started/","__resourceUrl":"/posts/ansible-get-started/index.html","__dataUrl":"/posts/ansible-get-started/index.html.8eafdfe578f666e17ea977379487f91b.json"},{"title":"Apache Tunning for Liferay","date":"2017-05-18T00:00:00.000Z","layout":"Post","hero":"../../assets/hands.svg","description":"vim /etc/sysconfig/httpd First change default prefork MPM for mutli-thread & multi-process worker MPM: vim /etc/httpd/conf/httpd.conf…","__filename":"posts/apache-tunning.md","__url":"/posts/apache-tunning/","__resourceUrl":"/posts/apache-tunning/index.html","__dataUrl":"/posts/apache-tunning/index.html.7e4f9059eaef2137da7b8db16d7ba444.json"},{"title":"Git for dummies","date":"2017-03-01T00:00:00.000Z","layout":"Post","hero":"../../assets/hands.svg","description":"The basis of any computer project is the SCM. Without a good SCM it will be difficult to reach a good port. So we want to show some first…","__filename":"posts/git-for-dummies.md","__url":"/posts/git-for-dummies/","__resourceUrl":"/posts/git-for-dummies/index.html","__dataUrl":"/posts/git-for-dummies/index.html.621305f08fdf79258f60863e568e8c11.json"},{"title":"Liferay DXP migration","date":"2017-04-26T00:00:00.000Z","layout":"Post","hero":"../../assets/hands.svg","description":"Configure OLD 6.2 Liferay Portal in local env Get mysql dump and store in local filesystem Start mysql docker container with 6.2 liferay…","__filename":"posts/liferay-dxp-migration.md","__url":"/posts/liferay-dxp-migration/","__resourceUrl":"/posts/liferay-dxp-migration/index.html","__dataUrl":"/posts/liferay-dxp-migration/index.html.f4a01711b785f74fcce5d2997adcd3a2.json"},{"title":"Redis high availavility installation","date":"2017-03-01T00:00:00.000Z","layout":"Post","hero":"../../assets/hands.svg","description":"Cookbook to install redis in high availability in master-slave tipology Install redis in a host &lt;APP_SERVER_1_IP> Fill form Configure…","__filename":"posts/redis-installation.md","__url":"/posts/redis-installation/","__resourceUrl":"/posts/redis-installation/index.html","__dataUrl":"/posts/redis-installation/index.html.1c7e1f8276cbcd677810934c104a103f.json"}];window.__INITIAL_STATE__ = {"pages":{"/posts/redis-installation/":{"head":{"title":"Redis high availavility installation","date":"2017-03-01T00:00:00.000Z","layout":"Post","hero":"../../assets/hands.svg","description":"Cookbook to install redis in high availability in master-slave tipology Install redis in a host &lt;APP_SERVER_1_IP> Fill form Configure…"},"body":"<p>Cookbook to install redis in high availability in master-slave tipology</p>\n<h1 id=\"install-redis-in-a-host-app_server_1_ip\"><a href=\"#install-redis-in-a-host-app_server_1_ip\" class=\"phenomic-HeadingAnchor\">#</a>Install redis in a host &#x3C;APP_SERVER_1_IP></h1>\n<pre><code class=\"hljs language-shell\">wget http:<span class=\"hljs-comment\">//download.redis.io/releases/redis-3.2.8.tar.gz</span>\ntar xzf redis-3.2.8.tar.gz\n<span class=\"hljs-keyword\">cd</span> redis-3.2.8/\nmake\n<span class=\"hljs-keyword\">cd</span> utils\nsudo ./install_server.<span class=\"hljs-keyword\">sh</span></code></pre>\n<h1 id=\"fill-form\"><a href=\"#fill-form\" class=\"phenomic-HeadingAnchor\">#</a>Fill form</h1>\n<pre><code class=\"hljs language-shell\"><span class=\"hljs-string\">Port           :</span> <span class=\"hljs-number\">6379</span>\nConfig <span class=\"hljs-string\">file    :</span> <span class=\"hljs-regexp\">/etc/</span>redis/redis_6379.conf\nLog <span class=\"hljs-string\">file       :</span> <span class=\"hljs-regexp\">/var/</span>log/redis_6379.log\nData <span class=\"hljs-string\">dir       :</span> <span class=\"hljs-regexp\">/var/</span>lib<span class=\"hljs-regexp\">/redis/</span><span class=\"hljs-number\">6379</span>\n<span class=\"hljs-string\">Executable     :</span> <span class=\"hljs-regexp\">/home/</span>vagrant<span class=\"hljs-regexp\">/redis-3.2.8/</span>src/redis-server\nCli <span class=\"hljs-string\">Executable :</span> <span class=\"hljs-regexp\">/home/</span>vagrant<span class=\"hljs-regexp\">/redis-3.2.8/</span>src/redis-clii</code></pre>\n<h1 id=\"configure-redis_6379conf-with-next-configuration\"><a href=\"#configure-redis_6379conf-with-next-configuration\" class=\"phenomic-HeadingAnchor\">#</a>Configure redis_6379.conf with next configuration</h1>\n<pre><code class=\"hljs language-shell\">bind &#x3C;APP_SERVER_1_IP> <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>\nport <span class=\"hljs-number\">6379</span>\nslave-priority <span class=\"hljs-number\">1</span></code></pre>\n<h1 id=\"create-sentinelconf-file\"><a href=\"#create-sentinelconf-file\" class=\"phenomic-HeadingAnchor\">#</a>Create sentinel.conf file</h1>\n<pre><code class=\"hljs language-shell\">bind &#x3C;APP_SERVER_1_IP>\nsentinel<span class=\"hljs-built_in\"> monitor </span>redismaster &#x3C;APP_SERVER_1_IP> 6379 2  \nsentinel down-after-milliseconds redismaster 6000 \ndaemonize yes\nloglevel verbose\nlogfile <span class=\"hljs-string\">\"/var/log/sentinel.log\"</span>\npidfile <span class=\"hljs-string\">\"/var/run/redis_26379.pid\"</span></code></pre>\n<h1 id=\"start-sentinel\"><a href=\"#start-sentinel\" class=\"phenomic-HeadingAnchor\">#</a>Start sentinel</h1>\n<pre><code class=\"hljs language-shell\">sudo ./install_server<span class=\"hljs-selector-class\">.sh</span>\n<span class=\"hljs-comment\">/*nohup ./redis-server /home/vagrant/redis-3.2.8/utils/sentinel.conf --sentinel &#x26;*/</span></code></pre>\n<h1 id=\"change-etcinitdredis_26379\"><a href=\"#change-etcinitdredis_26379\" class=\"phenomic-HeadingAnchor\">#</a>Change /etc/init.d/redis_26379</h1>\n<pre><code class=\"hljs language-shell\"><span class=\"hljs-meta\">#!/bin/sh</span>\n<span class=\"hljs-comment\">#Configurations injected by install_server below....</span>\n\nEXEC=/home/vagrant/redis-3.2.8/src/redis-server\nCLIEXEC=/home/vagrant/redis-3.2.8/src/redis-cli\nPIDFILE=/var/run/redis_26379.pid\nCONF=<span class=\"hljs-string\">\"/etc/redis/sentinel.conf\"</span>\nREDISPORT=<span class=\"hljs-string\">\"26379\"</span>\nLOGFILE=<span class=\"hljs-string\">\"/var/log/sentinel.log\"</span>\n<span class=\"hljs-comment\">###############</span>\n<span class=\"hljs-comment\"># SysV Init Information</span>\n<span class=\"hljs-comment\"># chkconfig: - 58 74</span>\n<span class=\"hljs-comment\"># description: redis_26379 is the redis daemon.</span>\n<span class=\"hljs-comment\">### BEGIN INIT INFO</span>\n<span class=\"hljs-comment\"># Provides: redis_26379</span>\n<span class=\"hljs-comment\"># Required-Start: $network $local_fs $remote_fs</span>\n<span class=\"hljs-comment\"># Required-Stop: $network $local_fs $remote_fs</span>\n<span class=\"hljs-comment\"># Default-Start: 2 3 4 5</span>\n<span class=\"hljs-comment\"># Default-Stop: 0 1 6</span>\n<span class=\"hljs-comment\"># Should-Start: $syslog $named</span>\n<span class=\"hljs-comment\"># Should-Stop: $syslog $named</span>\n<span class=\"hljs-comment\"># Short-Description: start and stop redis_26379</span>\n<span class=\"hljs-comment\"># Description: Redis daemon</span>\n<span class=\"hljs-comment\">### END INIT INFO</span>\n\n\n<span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">\"<span class=\"hljs-variable\">$1</span>\"</span> <span class=\"hljs-keyword\">in</span>\n    start)\n        <span class=\"hljs-keyword\">if</span> [ <span class=\"hljs-_\">-f</span> <span class=\"hljs-variable\">$PIDFILE</span> ]\n        <span class=\"hljs-keyword\">then</span>\n            <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"<span class=\"hljs-variable\">$PIDFILE</span> exists, process is already running or crashed\"</span>\n        <span class=\"hljs-keyword\">else</span>\n            <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"Starting Redis server...\"</span>\n            <span class=\"hljs-variable\">$EXEC</span> <span class=\"hljs-variable\">$CONF</span> --sentinel\n        <span class=\"hljs-keyword\">fi</span>\n        ;;\n    stop)\n        <span class=\"hljs-keyword\">if</span> [ ! <span class=\"hljs-_\">-f</span> <span class=\"hljs-variable\">$PIDFILE</span> ]\n        <span class=\"hljs-keyword\">then</span>\n            <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"<span class=\"hljs-variable\">$PIDFILE</span> does not exist, process is not running\"</span>\n        <span class=\"hljs-keyword\">else</span>\n            PID=$(cat <span class=\"hljs-variable\">$PIDFILE</span>)\n            <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"Stopping ...\"</span>\n            <span class=\"hljs-built_in\">kill</span> -9 <span class=\"hljs-variable\">$PID</span>\n            rm <span class=\"hljs-variable\">$PIDFILE</span>\n            <span class=\"hljs-keyword\">while</span> [ -x /proc/<span class=\"hljs-variable\">${PID}</span> ]\n            <span class=\"hljs-keyword\">do</span>\n                <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"Waiting for Redis to shutdown ...\"</span>\n                sleep 1\n            <span class=\"hljs-keyword\">done</span>\n            <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"Redis stopped\"</span>\n        <span class=\"hljs-keyword\">fi</span>\n        ;;\n    status)\n        PID=$(cat <span class=\"hljs-variable\">$PIDFILE</span>)\n        <span class=\"hljs-keyword\">if</span> [ ! -x /proc/<span class=\"hljs-variable\">${PID}</span> ]\n        <span class=\"hljs-keyword\">then</span>\n            <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">'Redis is not running'</span>\n        <span class=\"hljs-keyword\">else</span>\n            <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"Redis is running (<span class=\"hljs-variable\">$PID</span>)\"</span>\n        <span class=\"hljs-keyword\">fi</span>\n        ;;\n    restart)\n        <span class=\"hljs-variable\">$0</span> stop\n        <span class=\"hljs-variable\">$0</span> start\n        ;;\n    *)\n        <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"Please use start, stop, restart or status as first argument\"</span>\n        ;;\n<span class=\"hljs-keyword\">esac</span></code></pre>\n<h1 id=\"install-redis-in-another-host-app_server_2_ip\"><a href=\"#install-redis-in-another-host-app_server_2_ip\" class=\"phenomic-HeadingAnchor\">#</a>Install redis in another host &#x3C;APP_SERVER_2_IP></h1>\n<pre><code class=\"hljs language-shell\">wget http:<span class=\"hljs-comment\">//download.redis.io/releases/redis-3.2.8.tar.gz</span>\ntar xzf redis-3.2.8.tar.gz\n<span class=\"hljs-keyword\">cd</span> redis-3.2.8/\nmake\n<span class=\"hljs-keyword\">cd</span> utils\nsudo ./install_server.<span class=\"hljs-keyword\">sh</span></code></pre>\n<h1 id=\"fill-form-1\"><a href=\"#fill-form-1\" class=\"phenomic-HeadingAnchor\">#</a>Fill form</h1>\n<pre><code class=\"hljs language-shell\"><span class=\"hljs-string\">Port           :</span> <span class=\"hljs-number\">6379</span>\nConfig <span class=\"hljs-string\">file    :</span> <span class=\"hljs-regexp\">/etc/</span>redis/<span class=\"hljs-number\">6379.</span>conf\nLog <span class=\"hljs-string\">file       :</span> <span class=\"hljs-regexp\">/var/</span>log/redis_6379.log\nData <span class=\"hljs-string\">dir       :</span> <span class=\"hljs-regexp\">/var/</span>lib<span class=\"hljs-regexp\">/redis/</span><span class=\"hljs-number\">6379</span>\n<span class=\"hljs-string\">Executable     :</span> <span class=\"hljs-regexp\">/home/</span>vagrant<span class=\"hljs-regexp\">/redis-3.2.8/</span>src/redis-server\nCli <span class=\"hljs-string\">Executable :</span> <span class=\"hljs-regexp\">/home/</span>vagrant<span class=\"hljs-regexp\">/redis-3.2.8/</span>src/redis-cli</code></pre>\n<h1 id=\"configure-redis_6379conf-with-next-configuration-1\"><a href=\"#configure-redis_6379conf-with-next-configuration-1\" class=\"phenomic-HeadingAnchor\">#</a>Configure redis_6379.conf with next configuration</h1>\n<pre><code class=\"hljs language-shell\">bind &#x3C;APP_SERVER_2_IP>\nport <span class=\"hljs-number\">6379</span>\nslave-priority <span class=\"hljs-number\">10</span>\nslaveof &#x3C;APP_SERVER_1_IP> <span class=\"hljs-number\">6379</span></code></pre>\n<h1 id=\"create-sentinelconf-file-1\"><a href=\"#create-sentinelconf-file-1\" class=\"phenomic-HeadingAnchor\">#</a>Create sentinel.conf file</h1>\n<pre><code class=\"hljs language-shell\">bind &#x3C;APP_SERVER_2_IP>\nsentinel<span class=\"hljs-built_in\"> monitor </span>redismaster &#x3C;APP_SERVER_2_IP> 6379 2  \nsentinel down-after-milliseconds redismaster 6000</code></pre>\n<h1 id=\"start-sentinel-1\"><a href=\"#start-sentinel-1\" class=\"phenomic-HeadingAnchor\">#</a>Start sentinel</h1>\n<pre><code class=\"hljs language-shell\">sudo ./install_server<span class=\"hljs-selector-class\">.sh</span>\n<span class=\"hljs-comment\">/*nohup ./redis-server /etc/redis/sentinel.conf --sentinel &#x26;*/</span></code></pre>\n<h1 id=\"install-sentinel-in-a-host-app_server_3_ip\"><a href=\"#install-sentinel-in-a-host-app_server_3_ip\" class=\"phenomic-HeadingAnchor\">#</a>Install sentinel in a host &#x3C;APP_SERVER_3_IP></h1>\n<pre><code class=\"hljs language-shell\">wget http:<span class=\"hljs-comment\">//download.redis.io/releases/redis-3.2.8.tar.gz</span>\ntar xzf redis-3.2.8.tar.gz\n<span class=\"hljs-keyword\">cd</span> redis-3.2.8/\nmake\n<span class=\"hljs-keyword\">cd</span> utils\nsudo ./install_server.<span class=\"hljs-keyword\">sh</span></code></pre>\n<h1 id=\"configure-sentinelconf\"><a href=\"#configure-sentinelconf\" class=\"phenomic-HeadingAnchor\">#</a>Configure sentinel.conf</h1>\n<pre><code class=\"hljs language-shell\">bind &#x3C;APP_SERVER_3_IP>\nsentinel<span class=\"hljs-built_in\"> monitor </span>redismaster &#x3C;APP_SERVER_3_IP> 6379 2</code></pre>\n<h1 id=\"start-sentinel-2\"><a href=\"#start-sentinel-2\" class=\"phenomic-HeadingAnchor\">#</a>Start sentinel</h1>\n<pre><code class=\"hljs language-shell\">sudo ./install_server<span class=\"hljs-selector-class\">.sh</span>\n<span class=\"hljs-comment\">/*nohup ./redis-server /home/vagrant/redis-3.2.8/sentinel.conf --sentinel &#x26;*/</span></code></pre>\n<h1 id=\"knowed-bugs\"><a href=\"#knowed-bugs\" class=\"phenomic-HeadingAnchor\">#</a>Knowed bugs</h1>\n<h2 id=\"if-you-see-in-log\"><a href=\"#if-you-see-in-log\" class=\"phenomic-HeadingAnchor\">#</a>If you see in log:</h2>\n<pre><code class=\"hljs language-shell\"><span class=\"hljs-number\">7137</span>:S <span class=\"hljs-number\">14</span> Mar <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">14.347</span> * Retrying <span class=\"hljs-keyword\">with</span> SYNC...\n<span class=\"hljs-number\">7137</span>:S <span class=\"hljs-number\">14</span> Mar <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">14.347</span> # MASTER aborted replication <span class=\"hljs-keyword\">with</span> an <span class=\"hljs-literal\">error</span>: ERR Can<span class=\"hljs-symbol\">'t</span> SYNC <span class=\"hljs-keyword\">while</span> <span class=\"hljs-keyword\">not</span> connected <span class=\"hljs-keyword\">with</span> my master\n<span class=\"hljs-number\">7137</span>:S <span class=\"hljs-number\">14</span> Mar <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">15.348</span> * Connecting <span class=\"hljs-keyword\">to</span> MASTER &#x3C;APP_SERVER_1_IP>:<span class=\"hljs-number\">6379</span>\n<span class=\"hljs-number\">7137</span>:S <span class=\"hljs-number\">14</span> Mar <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">15.349</span> * MASTER &#x3C;-> SLAVE sync started\n<span class=\"hljs-number\">7137</span>:S <span class=\"hljs-number\">14</span> Mar <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">15.349</span> * Non blocking connect <span class=\"hljs-keyword\">for</span> SYNC fired the event.\n<span class=\"hljs-number\">7137</span>:S <span class=\"hljs-number\">14</span> Mar <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">15.350</span> * Master replied <span class=\"hljs-keyword\">to</span> PING, replication can continue...\n<span class=\"hljs-number\">7137</span>:S <span class=\"hljs-number\">14</span> Mar <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">15.350</span> * Partial resynchronization <span class=\"hljs-keyword\">not</span> possible (no cached master)\n<span class=\"hljs-number\">7137</span>:S <span class=\"hljs-number\">14</span> Mar <span class=\"hljs-number\">08</span>:<span class=\"hljs-number\">22</span>:<span class=\"hljs-number\">15.351</span> * Master does <span class=\"hljs-keyword\">not</span> support PSYNC <span class=\"hljs-keyword\">or</span> <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">in</span> <span class=\"hljs-literal\">error</span> state (reply: -ERR Can<span class=\"hljs-symbol\">'t</span> SYNC <span class=\"hljs-keyword\">while</span> <span class=\"hljs-keyword\">not</span> connected <span class=\"hljs-keyword\">with</span> my master)</code></pre>\n<p>You need to connect to redis-cli and execute this commands:</p>\n<pre><code class=\"hljs language-shell\">CONFIG <span class=\"hljs-keyword\">SET</span> <span class=\"hljs-keyword\">slave</span>-serve-stale-<span class=\"hljs-keyword\">data</span> yes\nSLAVEOF <span class=\"hljs-keyword\">NO</span> ONE\nCONFIG <span class=\"hljs-keyword\">SET</span> <span class=\"hljs-keyword\">slave</span>-serve-stale-<span class=\"hljs-keyword\">data</span> <span class=\"hljs-keyword\">no</span></code></pre>\n<h1 id=\"cli-command-utils\"><a href=\"#cli-command-utils\" class=\"phenomic-HeadingAnchor\">#</a>cli command utils</h1>\n<pre><code class=\"hljs language-shell\">/home/vagrant/redis-3.2.8/src/redis-cli\n\nTo see node role\n\nINFO Replication\n\nTo see all stored data in <span class=\"hljs-keyword\">cache</span>\n\n<span class=\"hljs-keyword\">KEYS</span> *\n\n<span class=\"hljs-keyword\">To</span> see all ordered <span class=\"hljs-keyword\">keys</span> \n\nZRANGE contactData~<span class=\"hljs-keyword\">keys</span> <span class=\"hljs-number\">0</span> <span class=\"hljs-number\">-1</span> WITHSCORES\n\n<span class=\"hljs-keyword\">To</span> <span class=\"hljs-keyword\">get</span> <span class=\"hljs-keyword\">value</span> <span class=\"hljs-keyword\">of</span> one <span class=\"hljs-keyword\">key</span>\n\n<span class=\"hljs-keyword\">GET</span> <span class=\"hljs-string\">\"&#x3C;&#x3C;key>>\"</span></code></pre>\n<p>Reference: <a href=\"http://enmilocalfunciona.io/configuracion-basica-de-un-cluster-redis-sentinel-bajo-unix/\">http://enmilocalfunciona.io/configuracion-basica-de-un-cluster-redis-sentinel-bajo-unix/</a></p>\n","__filename":"posts/redis-installation.md","__url":"/posts/redis-installation/","__resourceUrl":"/posts/redis-installation/index.html","__dataUrl":"/posts/redis-installation/index.html.1c7e1f8276cbcd677810934c104a103f.json","type":"Post"}}}</script><script src="/phenomic.browser.94be5559fb149406d8d5.js"></script></body></html>