<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[jgipsy]]></title><description><![CDATA[jgipsy]]></description><link>https://jgipsy.github.io</link><generator>RSS for Node</generator><lastBuildDate>Tue, 14 Mar 2017 14:56:09 GMT</lastBuildDate><atom:link href="https://jgipsy.github.io/feed.xml" rel="self" type="application/rss+xml"/><item><title><![CDATA[Redis high availavility installation]]></title><description><![CDATA[<h1 id="install-redis-in-a-host-app_server_1_ip"><a href="#install-redis-in-a-host-app_server_1_ip" class="phenomic-HeadingAnchor">#</a>Install redis in a host &#x3C;APP_SERVER_1_IP></h1>
<pre><code class="hljs language-shell">wget http:<span class="hljs-comment">//download.redis.io/releases/redis-3.2.8.tar.gz</span>
tar xzf redis-3.2.8.tar.gz
<span class="hljs-keyword">cd</span> redis-3.2.8/
make
<span class="hljs-keyword">cd</span> utils
sudo ./install_server.<span class="hljs-keyword">sh</span></code></pre>
<h1 id="fill-form"><a href="#fill-form" class="phenomic-HeadingAnchor">#</a>Fill form</h1>
<p>Port           : 6379
Config file    : /etc/redis/redis_6379.conf
Log file       : /var/log/redis_6379.log
Data dir       : /var/lib/redis/6379
Executable     : /home/vagrant/redis-3.2.8/src/redis-server
Cli Executable : /home/vagrant/redis-3.2.8/src/redis-clii</p>
<h1 id="configure-redis_6379conf-with-next-configuration"><a href="#configure-redis_6379conf-with-next-configuration" class="phenomic-HeadingAnchor">#</a>Configure redis_6379.conf with next configuration</h1>
<p>bind &#x3C;APP_SERVER_1_IP> 127.0.0.1
port 6379
slave-priority 1</p>
<h1 id="create-sentinelconf-file"><a href="#create-sentinelconf-file" class="phenomic-HeadingAnchor">#</a>Create sentinel.conf file</h1>
<p>bind &#x3C;APP_SERVER_1_IP>
sentinel monitor bonpreu &#x3C;APP_SERVER_1_IP> 6379 2<br>
sentinel down-after-milliseconds bonpreu 6000
daemonize yes
loglevel verbose
logfile "/var/log/sentinel.log"
pidfile "/var/run/redis_26379.pid"</p>
<h1 id="start-sentinel"><a href="#start-sentinel" class="phenomic-HeadingAnchor">#</a>Start sentinel</h1>
<p>sudo ./install_server.sh
/<em>nohup ./redis-server /home/vagrant/redis-3.2.8/utils/sentinel.conf --sentinel &#x26;</em>/</p>
<h1 id="change-etcinitdredis_26379"><a href="#change-etcinitdredis_26379" class="phenomic-HeadingAnchor">#</a>Change /etc/init.d/redis_26379</h1>
<p>#!/bin/sh
#Configurations injected by install_server below....</p>
<pre><code class="hljs language-shell">EXEC=/home/vagrant/redis-3.2.8/src/redis-server
CLIEXEC=/home/vagrant/redis-3.2.8/src/redis-cli
PIDFILE=/var/run/redis_26379.pid
CONF=<span class="hljs-string">"/etc/redis/sentinel.conf"</span>
REDISPORT=<span class="hljs-string">"26379"</span>
LOGFILE=<span class="hljs-string">"/var/log/sentinel.log"</span>
<span class="hljs-comment">###############</span>
<span class="hljs-comment"># SysV Init Information</span>
<span class="hljs-comment"># chkconfig: - 58 74</span>
<span class="hljs-comment"># description: redis_26379 is the redis daemon.</span>
<span class="hljs-comment">### BEGIN INIT INFO</span>
<span class="hljs-comment"># Provides: redis_26379</span>
<span class="hljs-comment"># Required-Start: $network $local_fs $remote_fs</span>
<span class="hljs-comment"># Required-Stop: $network $local_fs $remote_fs</span>
<span class="hljs-comment"># Default-Start: 2 3 4 5</span>
<span class="hljs-comment"># Default-Stop: 0 1 6</span>
<span class="hljs-comment"># Should-Start: $syslog $named</span>
<span class="hljs-comment"># Should-Stop: $syslog $named</span>
<span class="hljs-comment"># Short-Description: start and stop redis_26379</span>
<span class="hljs-comment"># Description: Redis daemon</span>
<span class="hljs-comment">### END INIT INFO</span>


<span class="hljs-keyword">case</span> <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> <span class="hljs-keyword">in</span>
    start)
        <span class="hljs-keyword">if</span> [ <span class="hljs-_">-f</span> <span class="hljs-variable">$PIDFILE</span> ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$PIDFILE</span> exists, process is already running or crashed"</span>
        <span class="hljs-keyword">else</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Starting Redis server..."</span>
            <span class="hljs-variable">$EXEC</span> <span class="hljs-variable">$CONF</span> --sentinel
        <span class="hljs-keyword">fi</span>
        ;;
    stop)
        <span class="hljs-keyword">if</span> [ ! <span class="hljs-_">-f</span> <span class="hljs-variable">$PIDFILE</span> ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$PIDFILE</span> does not exist, process is not running"</span>
        <span class="hljs-keyword">else</span>
            PID=$(cat <span class="hljs-variable">$PIDFILE</span>)
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Stopping ..."</span>
            <span class="hljs-built_in">kill</span> -9 <span class="hljs-variable">$PID</span>
            rm <span class="hljs-variable">$PIDFILE</span>
            <span class="hljs-keyword">while</span> [ -x /proc/<span class="hljs-variable">${PID}</span> ]
            <span class="hljs-keyword">do</span>
                <span class="hljs-built_in">echo</span> <span class="hljs-string">"Waiting for Redis to shutdown ..."</span>
                sleep 1
            <span class="hljs-keyword">done</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Redis stopped"</span>
        <span class="hljs-keyword">fi</span>
        ;;
    status)
        PID=$(cat <span class="hljs-variable">$PIDFILE</span>)
        <span class="hljs-keyword">if</span> [ ! -x /proc/<span class="hljs-variable">${PID}</span> ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">'Redis is not running'</span>
        <span class="hljs-keyword">else</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Redis is running (<span class="hljs-variable">$PID</span>)"</span>
        <span class="hljs-keyword">fi</span>
        ;;
    restart)
        <span class="hljs-variable">$0</span> stop
        <span class="hljs-variable">$0</span> start
        ;;
    *)
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"Please use start, stop, restart or status as first argument"</span>
        ;;
<span class="hljs-keyword">esac</span></code></pre>
<h1 id="install-redis-in-another-host-17220162"><a href="#install-redis-in-another-host-17220162" class="phenomic-HeadingAnchor">#</a>Install redis in another host 172.20.16.2</h1>
<pre><code class="hljs language-shell">wget http:<span class="hljs-comment">//download.redis.io/releases/redis-3.2.8.tar.gz</span>
tar xzf redis-3.2.8.tar.gz
<span class="hljs-keyword">cd</span> redis-3.2.8/
make
<span class="hljs-keyword">cd</span> utils
sudo ./install_server.<span class="hljs-keyword">sh</span></code></pre>
<h1 id="fill-form-1"><a href="#fill-form-1" class="phenomic-HeadingAnchor">#</a>Fill form</h1>
<p>Port           : 6379
Config file    : /etc/redis/6379.conf
Log file       : /var/log/redis_6379.log
Data dir       : /var/lib/redis/6379
Executable     : /home/vagrant/redis-3.2.8/src/redis-server
Cli Executable : /home/vagrant/redis-3.2.8/src/redis-cli</p>
<h1 id="configure-redis_6379conf-with-next-configuration-1"><a href="#configure-redis_6379conf-with-next-configuration-1" class="phenomic-HeadingAnchor">#</a>Configure redis_6379.conf with next configuration</h1>
<p>bind &#x3C;APP_SERVER_2_IP>
port 6379
slave-priority 10
slaveof &#x3C;APP_SERVER_1_IP> 6379</p>
<h1 id="create-sentinelconf-file-1"><a href="#create-sentinelconf-file-1" class="phenomic-HeadingAnchor">#</a>Create sentinel.conf file</h1>
<p>bind &#x3C;APP_SERVER_2_IP>
sentinel monitor bonpreu &#x3C;APP_SERVER_2_IP> 6379 2<br>
sentinel down-after-milliseconds bonpreu 6000</p>
<h1 id="start-sentinel-1"><a href="#start-sentinel-1" class="phenomic-HeadingAnchor">#</a>Start sentinel</h1>
<p>sudo ./install_server.sh
/<em>nohup ./redis-server /etc/redis/sentinel.conf --sentinel &#x26;</em>/</p>
<h1 id="install-sentinel-in-a-host-app_server_3_ip"><a href="#install-sentinel-in-a-host-app_server_3_ip" class="phenomic-HeadingAnchor">#</a>Install sentinel in a host &#x3C;APP_SERVER_3_IP></h1>
<pre><code class="hljs language-shell">wget http:<span class="hljs-comment">//download.redis.io/releases/redis-3.2.8.tar.gz</span>
tar xzf redis-3.2.8.tar.gz
<span class="hljs-keyword">cd</span> redis-3.2.8/
make
<span class="hljs-keyword">cd</span> utils
sudo ./install_server.<span class="hljs-keyword">sh</span></code></pre>
<h1 id="configure-sentinelconf"><a href="#configure-sentinelconf" class="phenomic-HeadingAnchor">#</a>Configure sentinel.conf</h1>
<p>bind &#x3C;APP_SERVER_3_IP>
sentinel monitor bonpreu &#x3C;APP_SERVER_3_IP> 6379 2</p>
<h1 id="start-sentinel-2"><a href="#start-sentinel-2" class="phenomic-HeadingAnchor">#</a>Start sentinel</h1>
<p>nohup ./redis-server /home/vagrant/redis-3.2.8/sentinel.conf --sentinel &#x26;</p>
<h1 id="knowed-bugs"><a href="#knowed-bugs" class="phenomic-HeadingAnchor">#</a>Knowed bugs</h1>
<h2 id="if-you-see-in-log"><a href="#if-you-see-in-log" class="phenomic-HeadingAnchor">#</a>If you see in log:</h2>
<pre><code class="hljs language-shell"><span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">14.347</span> * Retrying <span class="hljs-keyword">with</span> SYNC...
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">14.347</span> # MASTER aborted replication <span class="hljs-keyword">with</span> an <span class="hljs-literal">error</span>: ERR Can<span class="hljs-symbol">'t</span> SYNC <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> connected <span class="hljs-keyword">with</span> my master
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.348</span> * Connecting <span class="hljs-keyword">to</span> MASTER <span class="hljs-number">172.20</span>.<span class="hljs-number">15.211</span>:<span class="hljs-number">6379</span>
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.349</span> * MASTER &#x3C;-> SLAVE sync started
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.349</span> * Non blocking connect <span class="hljs-keyword">for</span> SYNC fired the event.
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.350</span> * Master replied <span class="hljs-keyword">to</span> PING, replication can continue...
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.350</span> * Partial resynchronization <span class="hljs-keyword">not</span> possible (no cached master)
<span class="hljs-number">7137</span>:S <span class="hljs-number">14</span> Mar <span class="hljs-number">08</span>:<span class="hljs-number">22</span>:<span class="hljs-number">15.351</span> * Master does <span class="hljs-keyword">not</span> support PSYNC <span class="hljs-keyword">or</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">in</span> <span class="hljs-literal">error</span> state (reply: -ERR Can<span class="hljs-symbol">'t</span> SYNC <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> connected <span class="hljs-keyword">with</span> my master)</code></pre>
<p>You need to connect to redis-cli and execute this commands:</p>
<pre><code class="hljs language-shell">CONFIG <span class="hljs-keyword">SET</span> <span class="hljs-keyword">slave</span>-serve-stale-<span class="hljs-keyword">data</span> yes
SLAVEOF <span class="hljs-keyword">NO</span> ONE
CONFIG <span class="hljs-keyword">SET</span> <span class="hljs-keyword">slave</span>-serve-stale-<span class="hljs-keyword">data</span> <span class="hljs-keyword">no</span></code></pre>
<h1 id="cli-command-utils"><a href="#cli-command-utils" class="phenomic-HeadingAnchor">#</a>cli command utils</h1>
<pre><code class="hljs language-shell">/home/vagrant/redis-3.2.8/src/redis-cli

To see node role

INFO Replication

To see all stored data in <span class="hljs-keyword">cache</span>

<span class="hljs-keyword">KEYS</span> *

<span class="hljs-keyword">To</span> see all ordered <span class="hljs-keyword">keys</span> 

ZRANGE contactData~<span class="hljs-keyword">keys</span> <span class="hljs-number">0</span> <span class="hljs-number">-1</span> WITHSCORES

<span class="hljs-keyword">To</span> <span class="hljs-keyword">get</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">of</span> one <span class="hljs-keyword">key</span>

<span class="hljs-keyword">GET</span> <span class="hljs-string">"&#x3C;&#x3C;key>>"</span></code></pre>
<p>Reference: <a href="http://enmilocalfunciona.io/configuracion-basica-de-un-cluster-redis-sentinel-bajo-unix/">http://enmilocalfunciona.io/configuracion-basica-de-un-cluster-redis-sentinel-bajo-unix/</a></p>
]]></description><link>https://jgipsy.github.io/posts/redis-installation/</link><guid isPermaLink="true">https://jgipsy.github.io/posts/redis-installation/</guid><pubDate>Wed, 01 Mar 2017 00:00:00 GMT</pubDate></item><item><title><![CDATA[Git for dummies]]></title><description><![CDATA[<p>The basis of any computer project is the SCM. Without a good SCM it will be difficult to reach a good port.
So we want to show some first steps to work with GIT.</p>
<p>To start working with GIT, we recommend using an approach to the central repository philosophy (SVN style) against the philosophy of distributed repositories.</p>
<p>For this it is important to have Gitlab or Github as the central repository.</p>
<p>Starting from the topology that code repositories are embedded in a central server (either gitlab or github) a simple and intuitive way of working is as follows:</p>
<ul>
<li>Clone the master branch (or development) of the code repository</li>
</ul>
<pre><code class="hljs language-shell">git <span class="hljs-keyword">clone</span> <span class="hljs-title">&#x3C;URL_REPO</span>>.git</code></pre>
<ul>
<li>Create a branch in local code for the functionality to be developed. It is important to create a branch for each functionality.</li>
</ul>
<pre><code class="hljs language-shell">git branch <span class="hljs-built_in">feature</span>/&#x3C;<span class="hljs-built_in">feature</span>-name></code></pre>
<ul>
<li>
<p>Work comfortably</p>
</li>
<li>
<p>Before uploading, update the code in local with the master branch</p>
</li>
</ul>
<pre><code class="hljs language-shell">git pull origin <span class="hljs-literal">master</span></code></pre>
<ul>
<li>
<p>If conflicts are found, solve them locally.</p>
</li>
<li>
<p>Upload the code developed to the central repository</p>
</li>
</ul>
<pre><code class="hljs language-shell">git add -A
git commit -m <span class="hljs-string">"comentario explicativo de las modificaicones realizadas"</span>
git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> <span class="hljs-built_in">feature</span>/&#x3C;<span class="hljs-built_in">feature</span>-name></code></pre>
<ul>
<li>
<p>Perform from the management of the central repository (gitlab or github) a merge request or pull request to the master branch</p>
</li>
<li>
<p>Check the merge request for another partner and do the code merge.</p>
</li>
</ul>
]]></description><link>https://jgipsy.github.io/posts/git-for-dummies/</link><guid isPermaLink="true">https://jgipsy.github.io/posts/git-for-dummies/</guid><pubDate>Wed, 01 Mar 2017 00:00:00 GMT</pubDate></item></channel></rss>